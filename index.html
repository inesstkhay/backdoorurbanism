<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>backdoorurbanism beta</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
        
</head>
<body>

<div id="navbar" class="navbar">
  <!-- même style que tes onglets actuels: on réutilise .tab-btn -->
  <button class="tab-btn top-tab active" data-top="fragments">Fragments</button>
  <button class="tab-btn top-tab" data-top="patterns">Patterns</button>
  <button class="tab-btn top-tab" data-top="unit">Unité de projet</button>

  <div id="brand-chip" class="brand-chip">
  <span>backdoorurbanism</span>
  <button id="info-btn" class="brand-info" title="À propos">i</button>
</div>

</div>

<!-- Sous-onglets : visible UNIQUEMENT quand "Patterns" est actif -->
<div id="subnav-patterns" class="subnav subnav--inactive">
  <button class="tab-btn sub-tab" data-sub="patterns-map">Carte</button>
  <button class="tab-btn sub-tab" data-sub="proxemic">Proxémie</button>
  <button class="tab-btn sub-tab" data-sub="gallery">Galerie</button>

  <!-- Action à droite ; pour l’instant “vide” -->
  <button id="create-unit-btn" class="tab-btn sub-action">Créer une Unité de Projet</button>
</div>

<!-- VUES PRINCIPALES -->
<div id="map" class="view active"><!-- ta carte Leaflet existante --></div>
<!-- (nouveau) Vue "Carte" de Patterns : vide pour l’instant -->
<div id="patterns-map" class="view" style="display:none;"></div>


<!-- Sidebar à onglets (uniquement pour la carte Patterns) -->
<div id="tabbed-sidebar" style="
  position:fixed; top:90px; right:10px; width:380px; max-height:calc(100vh - 120px);
  display:none; background:#fff; border:1px solid #ccc; z-index:4002; overflow:hidden; font-family:'Consolas', monospace;">
  <div id="tabbed-sidebar-tabs" style="display:flex; gap:4px; padding:6px; background:#000; border-bottom:1px solid #333; overflow-x:auto;">
    <!-- boutons d’onglets dynamiques -->
  </div>
  <div id="tabbed-sidebar-content" style="overflow:auto; max-height:calc(100vh - 160px); padding:10px;">
    <!-- panneaux dynamiques -->
  </div>
</div>


<!-- Vue proxémie existante (ta “patterns/proxémie”) -->
<div id="proxemic-view" class="view" style="display:none;"></div>
<!-- Vue galerie existante -->
<div id="gallery-view" class="view" style="display:none; position: absolute; top: 55px; left: 10px; /* pour ne pas passer sous les filtres */ right: 0; bottom: 0; background: white; overflow-y: auto; z-index: 100;     padding: 80px;     box-sizing: border-box; "></div>
<!-- (nouveau) Vue "Unité de projet" : vide pour l’instant -->
<div id="unit-view" class="view" style="display:none;"></div>

<div id="similarity-controls" style="display:none; position: absolute; top: 90px; left: 50%; color: white; transform: translateX(-50%); background: rgb(0, 0, 0); padding: 10px; z-index: 1050; border: 1px solid #ccc;">
    <label for="similarity-slider">Nombre de critères communs : <span id="slider-value">5</span></label><br>
    <input type="range" id="similarity-slider" min="2" max="15" value="5" step="1"> </div>
<div id="critical-view" style=" display: none; position: absolute;     top: 90px;     left: 50%;     transform: translateX(-50%);     width: 600px;    height: 600px;    background: white;    z-index: 100;    padding: 0;    box-sizing: border-box;     overflow: hidden;"> </div>

<!-- PANNELS LATÉRAUX -->
<div id="spatial-sidebar" class="sidebar">
    <button class="close-btn" onclick="closeSidebars()">X</button>
    <h2 id="spatial-name"></h2>
    <p><strong>ID :</strong> <span id="spatial-id"></span></p>
    <p id="spatial-description"></p>
    <div id="spatial-photos"></div>
</div>


<div id="discourse-sidebar" class="sidebar">
    <button class="close-btn" onclick="closeSidebars()">X</button>
    <h2 id="discourse-name"></h2>
    <p><strong>Auteur :</strong> <span id="discourse-author"></span></p>
    <p><strong>Date :</strong> <span id="discourse-date"></span></p>
    <p><strong>Source :</strong> <span id="discourse-source"></span></p>
    <p id="discourse-text"></p>
</div>

<!-- CONTRÔLES -->

<div id="filters">
    <strong>Zones</strong><br>
<label><input type="checkbox" class="filter-zone" value="montreuil" checked> Montreuil</label><br>
<label><input type="checkbox" class="filter-zone" value="mirail" checked> Mirail</label><br>
   </div>

   <!-- LEGENDE -->

   <div id="criteria-legend" style="position: absolute;  display: none; bottom: 60px; left: 10px; width: 320px; background: white; border: 1px solid #ccc; padding: 10px; font-size: 12px; z-index: 1050; overflow-y: auto; max-height: 50vh;">
    <strong>Légende des critères</strong><br><br>
    <em>Espace perçu (usage)</em><br>
    - Fréquence d’usage : ponctuel, régulier, quotidien<br>
    - Mode d’usage : prévu, détourné, créatif<br>
    - Intensité d’usage : faible, moyenne, forte, saturée<br><br>

    <em>Espace conçu</em><br>
    - Échelle : micro, méso, macro<br>
    - Origine de la forme : institutionnelle, singulière, collective<br>
    - Accessibilité : libre, semi-ouverte, fermée<br>
    - Visibilité : caché, visible, exposé<br><br>

    <em>Espace vécu (expérience)</em><br>
    - Acteurs visibles : habitant·e, institution, collectif, invisible<br>
    - Rapport affectif / symbolique
</div>

<button id="toggle-legend-btn" style="
    position: absolute;
    bottom: 20px;
    left: 10px;
    z-index: 1050;
    background-color: #000;
    color: white;
    padding: 10px;
    border: 1px solid white;
    cursor: pointer;
    font-family: 'Consolas', monospace;
">Légende</button>


<button id="toggle-location-btn"
  class="view-toggle-btn"
  onclick="toggleLocation()"
  style="position:absolute; top:90px; right:10px; z-index:1050; background:#000; color:#fff; padding:10px; border:1px solid #fff; cursor:pointer; font-family:'Consolas', monospace;">
  Voir Toulouse
</button>


<div id="about">
    <h2>À propos</h2>
    <p>Description.</p>
    <p>Developpé par Iness Tkhayyare, LRA ENSA Toulouse</p>
</div>

<script defer src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script defer src="https://d3js.org/d3.v7.min.js"></script>
<script defer src="script.js"></script>




<!-- Fine barre noire en bas -->
<div id="footer-strip" style="
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: 20px;              /* ajuste l'épaisseur ici */
  background: #000;
  z-index: 3000;             /* au-dessus de la carte */
    border-top: 0.2px solid #585858; /* contour blanc en haut */
  pointer-events: none;      /* ne bloque pas les clics sur la carte */
"></div>


<!-- Hint flottant pour la création d'Unité de Projet -->
<div id="unit-hint" style="
  position:fixed; top:0; left:0; transform: translate(-50%,-140%);
  padding:6px 8px; background:#000; color:#fff; border:1px solid #fff;
  font-family:'Consolas', monospace; font-size:13px; z-index:100000; 
  display:none; pointer-events:none; white-space:nowrap;">
  Sélectionnez un fragment sur la carte
</div>



</body>
</html>